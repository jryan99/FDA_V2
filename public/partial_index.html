
     document.addEventListener('DOMContentLoaded', function() {
     var openbankProvider = document.getElementById('openbank-provider');
     if (openbankProvider) {
         openbankProvider.onclick = async function() {
         // your Plaid link code here
       
       /**
       * Plaid Link Handler
       */
      openbankProvider.onclick = async () => {
        try {
          const res = await fetch('/api/create_link_token', { method: 'POST' });
          const data = await res.json();
          if (!data.link_token) throw new Error('No link token');
          
          const handler = Plaid.create({
            token: data.link_token,
            onSuccess: (public_token, metadata) => {
              // Placeholder: replace with real IDs or token exchange
              displayBankData('ACCESS_TOKEN', 'ACCOUNT_ID', metadata.institution.id);
            }
          });
          handler.open();
        } catch (err) {
          alert('Plaid Link error: ' + err.message);
        }
      };
      
      /**
       * Display Bank Data in Overlay
       */
      window.displayBankData = (accessToken, accountId, customerId) => {
        fetch(`/api/get_bank_data?accountId=${accountId}&customerId=${customerId}`)
          .then(r => r.json())
          .then(data => { 
            const table = document.createElement('table');
            table.innerHTML = `<tr><th>Account</th><th>Balance</th><th>Type</th></tr>`;
            data.accounts.forEach(acct => {
              const tr = document.createElement('tr');
              tr.innerHTML = `<td>${acct.accountNumber}</td><td>${acct.balance}</td><td>${acct.type}</td>`;
              table.appendChild(tr);
            });
            document.getElementById('bank-data-table').innerHTML = '';
            document.getElementById('bank-data-table').appendChild(table);
            bankOverlay.style.display = 'block';
          })
          .catch(e => alert('Fetch error: ' + e.message));
      };
      
      /**
       * Close Bank Data Overlay
       */
      closeOverlayBtn.onclick = () => {
        bankOverlay.style.display = 'none';
      };
    }
  }
    });
  </script>
</body>
</html>
~      
